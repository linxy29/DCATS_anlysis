---
title: "Test the usage OF ANCOMBC"
output: html_document
---

```{r}
#library(phyloseq)
library(tidyverse)
library(ANCOMBC)
library(TreeSummarizedExperiment)
```

## ancombc2

```{r}
assay_data <- matrix((1:24)*5, nrow = 6)
colnames(assay_data) <- paste0("sample", 1:4)
rownames(assay_data) <- paste("entity", seq_len(6), sep = "")
assay_data
```

```{r}
# column data (sample annotations)
col_data <- data.frame(gg = c(1, 2, 3, 3),
                       group = rep(LETTERS[1:2], each = 2), 
                       row.names = colnames(assay_data),
                       stringsAsFactors = FALSE)
col_data
```

```{r}
tse = TreeSummarizedExperiment(assays = list(counts = assay_data),
                                     colData = col_data)
tse
```

```{r}
output = ancombc2(data = tse, assay_name = "counts",
                  fix_formula = "gg + group",
                  p_adj_method = "holm")
output$res
```





